{% load i18n %}
{% trans "Choose a document" as  choose_str %}
{% include "wagtailadmin/shared/header.html" with title=choose_str tabbed=1 merged=1 icon="doc-full-inverse" %}

{% if uploadform %}
    <ul class="tab-nav merged">
        <li class="active"><a href="#search">{% trans "Search" %}</a></li>
        <li><a href="#upload">{% trans "Upload" %}</a></li>
    </ul>
{% endif %}

<div class="tab-content">
    <section id="search" class="active nice-padding">
        <form class="document-search search-bar" action="{% url 'wagtaildocs_chooser' %}" method="GET">
            <ul class="fields">
                {% for field in searchform %}
                    {% include "wagtailadmin/shared/field_as_li.html" with field=field %}
                {% endfor %}
                <li class="submit"><input type="submit" value="{% trans 'Search' %}" /></li>
            </ul>
        </form>
        <div id="search-results" class="listing documents">
            {% include "wagtaildocs/chooser/results.html" %}
        </div>
    </section>
    {% if uploadform %}
        <section id="upload" class="nice-padding">
            <div id="{{ uploadid }}">

                <div class="drop-zone">
                    <p>{% trans "Drag and drop documents into this area to upload immediately." %}</p>

                    <form method="POST" enctype="multipart/form-data"
                          action="{% url 'wagtaildocs_chooser_upload' %}">
                        <div class="replace-file-input">
                            <button class="bicolor icon icon-plus">{% trans "Or choose from your computer" %}</button>
                            <input class="fileupload" type="file" name="files[]" />
                        </div>
                        {% csrf_token %}
                    </form>
                </div>

                <div class="progress progress-secondary">
                    <div class="bar" style="width: 0%;">0%</div>
                </div>

                <ul class="upload-list multiple"></ul>
                {% include "wagtaildocs/multiple/list_item.html" %}
            </div>
        </section>
        {% url 'wagtailadmin_tag_autocomplete' as autocomplete_url %}
        <script>
            $(function() {
                add_file_upload_widget($('#{{ uploadid }}'));
            });
            window.simple_upload_url = "{% url 'wagtaildocs_add_document' %}";
            window.tagit_opts = {
                autocomplete: {source: "{{ autocomplete_url|addslashes }}"}
            };
        </script>

    {% endif %}
</div>
